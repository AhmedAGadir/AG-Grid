{"version":3,"file":"index.js","sourceRoot":"","sources":["../index.ts"],"names":[],"mappings":";;AAAA,6BAA8D;AAG9D,wCAA6C;AAE7C,6CAIyB;AACzB,2DAIgC;AAEhC,6CAIyB;AAHvB,uCAAA,gBAAgB,CAAA;AAChB,wCAAA,iBAAiB,CAAA;AACjB,yCAAA,kBAAkB,CAAA;AAGpB,aACE,OAAe,EACf,MAAY,EACZ,KAAW;IAEX,OAAO,IAAI,oCAAiB,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;AAC9D,CAAC;AAND,kBAMC;AAED,cACE,OAAe,EACf,MAAY,EACZ,KAAW;IAEX,OAAO,IAAI,qCAAkB,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;AAC/D,CAAC;AAND,oBAMC;AAED,cAAqB,OAAe;IAClC,OAAO,4BAAgB,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC;AACvD,CAAC;AAFD,oBAEC;AAiBD;;;;EAIE;AACF,oCACE,UAA2B,EAC3B,UAAkB;IAElB,IAAM,QAAQ,GAAkB,EAAE,CAAC;IACnC,IAAM,SAAS,GAAG,4BAAgB,EAAE,CAAC;IAErC,UAAU,CAAC,SAAS,CAClB,UAAA,KAAK;QACH,QAAQ,CAAC,IAAI,CAAC;YACZ,KAAK,EAAE,SAAS,CAAC,KAAK,GAAG,UAAU;YACnC,YAAY,EAAE,mBAAY,CAAC,UAAU,CAAC,KAAK,CAAC;SAC7C,CAAC,CAAC;IACL,CAAC,EACD,UAAA,GAAG;QACD,QAAQ,CAAC,IAAI,CAAC;YACZ,KAAK,EAAE,SAAS,CAAC,KAAK,GAAG,UAAU;YACnC,YAAY,EAAE,mBAAY,CAAC,WAAW,CAAC,GAAG,CAAC;SAC5C,CAAC,CAAC;IACL,CAAC,EACD;QACE,QAAQ,CAAC,IAAI,CAAC;YACZ,KAAK,EAAE,SAAS,CAAC,KAAK,GAAG,UAAU;YACnC,YAAY,EAAE,mBAAY,CAAC,cAAc,EAAE;SAC5C,CAAC,CAAC;IACL,CAAC,CACF,CAAC;IACF,OAAO,QAAQ,CAAC;AAClB,CAAC;AAED;IACE,OAAO,CAAC,WAAW,CAAC;QAClB,mBAAmB,EAAE,cAAM,OAAA,CAAC;YAC1B,OAAO,EAAE,UAAS,MAAsB,EAAE,OAA0B;gBAClE,IAAM,YAAY,GAChB,OAAO,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;gBACpD,IAAM,OAAO,GAAsB,YAAY,CAAC,GAAG,CAAC,UAAA,OAAO;oBACzD,OAAA,uBAAa,CAAC,2BAA2B,CAAC,OAAO,CAAC;gBAAlD,CAAkD,CACnD,CAAC;gBAEF,MAAM,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC;gBAEnD,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;YACxB,CAAC;SACF,CAAC,EAZyB,CAYzB;QACF,cAAc,EAAE,cAAM,OAAA,CAAC;YACrB,OAAO,EAAE,UAAS,MAAsB,EAAE,OAAuB;gBAC/D,IAAM,OAAO,GAAkB,EAAE,CAAC;gBAClC,IAAI,YAA0B,CAAC;gBAC/B,IAAM,SAAS,GAAG,4BAAgB,EAAE,CAAC;gBAErC,SAAS,CAAC,QAAQ,CAAC;oBACjB,YAAY,GAAG,MAAM,CAAC,SAAS,CAC7B,UAAC,CAAM;wBACL,IAAI,KAAK,GAAG,CAAC,CAAC;wBAEd,oCAAoC;wBACpC,IAAI,CAAC,YAAY,iBAAU,EAAE;4BAC3B,KAAK,GAAG,0BAA0B,CAAC,KAAK,EAAE,SAAS,CAAC,KAAK,CAAC,CAAC;yBAC5D;wBAED,OAAO,CAAC,IAAI,CAAC;4BACX,KAAK,EAAE,SAAS,CAAC,KAAK;4BACtB,YAAY,EAAE,mBAAY,CAAC,UAAU,CAAC,KAAK,CAAC;yBAC7C,CAAC,CAAC;oBACL,CAAC,EACD,UAAC,GAAQ;wBACP,OAAO,CAAC,IAAI,CAAC;4BACX,KAAK,EAAE,SAAS,CAAC,KAAK;4BACtB,YAAY,EAAE,mBAAY,CAAC,WAAW,CAAC,GAAG,CAAC;yBAC5C,CAAC,CAAC;oBACL,CAAC,EACD;wBACE,OAAO,CAAC,IAAI,CAAC;4BACX,KAAK,EAAE,SAAS,CAAC,KAAK;4BACtB,YAAY,EAAE,mBAAY,CAAC,cAAc,EAAE;yBAC5C,CAAC,CAAC;oBACL,CAAC,CACF,CAAC;gBACJ,CAAC,CAAC,CAAC;gBACH,SAAS,CAAC,KAAK,EAAE,CAAC;gBAElB,IAAM,QAAQ,GAAG,uBAAa,CAAC,YAAY,CACzC,OAAO,CAAC,OAAO,EACf,OAAO,CAAC,MAAM,EACd,OAAO,CAAC,KAAK,EACb,IAAI,EACJ,IAAI,CACL,CAAC;gBAEF,MAAM,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;gBAElC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;YACxB,CAAC;SACF,CAAC,EAjDoB,CAiDpB;KACH,CAAC,CAAC;AACL,CAAC;AAlED,kCAkEC;AAED,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,OAAO,EAAE;IAChD,OAAO,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC,cAAM,OAAA,WAAW,EAAE,EAAb,CAAa,CAAC,CAAC;IAEhD,OAAO,CAAC,MAAM,EAAE,CAAC,UAAU,CAAC,cAAM,OAAA,6BAAiB,EAAE,EAAnB,CAAmB,CAAC,CAAC;IACvD,OAAO,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC;QACzB,4BAAgB,EAAE,CAAC,KAAK,EAAE,CAAC;QAC3B,8BAAkB,EAAE,CAAC;IACvB,CAAC,CAAC,CAAC;CACJ","sourcesContent":["import { Notification, Observable, Subscription } from 'rxjs';\nimport { SubscriptionLog } from 'rxjs/internal/testing/SubscriptionLog';\nimport { TestMessage } from 'rxjs/internal/testing/TestMessage';\nimport { TestScheduler } from 'rxjs/testing';\n\nimport {\n  getTestScheduler,\n  initTestScheduler,\n  resetTestScheduler,\n} from './src/scheduler';\nimport {\n  TestColdObservable,\n  TestHotObservable,\n  TestObservable,\n} from './src/test-observables';\n\nexport {\n  getTestScheduler,\n  initTestScheduler,\n  resetTestScheduler,\n} from './src/scheduler';\n\nexport function hot(\n  marbles: string,\n  values?: any,\n  error?: any,\n): TestHotObservable {\n  return new TestHotObservable(marbles.trim(), values, error);\n}\n\nexport function cold(\n  marbles: string,\n  values?: any,\n  error?: any,\n): TestColdObservable {\n  return new TestColdObservable(marbles.trim(), values, error);\n}\n\nexport function time(marbles: string): number {\n  return getTestScheduler().createTime(marbles.trim());\n}\n\ndeclare global {\n  namespace jasmine {\n    interface Matchers<T> {\n      toBeObservable: any;\n      toHaveSubscriptions: any;\n    }\n  }\n  namespace jest {\n    interface Matchers<R> {\n      toBeObservable: any;\n      toHaveSubscriptions: any;\n    }\n  }\n}\n\n/*\n* Based on source code found in rxjs library\n* https://github.com/ReactiveX/rxjs/blob/master/src/testing/TestScheduler.ts\n*\n*/\nfunction materializeInnerObservable(\n  observable: Observable<any>,\n  outerFrame: number,\n): TestMessage[] {\n  const messages: TestMessage[] = [];\n  const scheduler = getTestScheduler();\n\n  observable.subscribe(\n    value => {\n      messages.push({\n        frame: scheduler.frame - outerFrame,\n        notification: Notification.createNext(value),\n      });\n    },\n    err => {\n      messages.push({\n        frame: scheduler.frame - outerFrame,\n        notification: Notification.createError(err),\n      });\n    },\n    () => {\n      messages.push({\n        frame: scheduler.frame - outerFrame,\n        notification: Notification.createComplete(),\n      });\n    },\n  );\n  return messages;\n}\n\nexport function addMatchers() {\n  jasmine.addMatchers({\n    toHaveSubscriptions: () => ({\n      compare: function(actual: TestObservable, marbles: string | string[]) {\n        const marblesArray: string[] =\n          typeof marbles === 'string' ? [marbles] : marbles;\n        const results: SubscriptionLog[] = marblesArray.map(marbles =>\n          TestScheduler.parseMarblesAsSubscriptions(marbles),\n        );\n\n        expect(results).toEqual(actual.getSubscriptions());\n\n        return { pass: true };\n      },\n    }),\n    toBeObservable: () => ({\n      compare: function(actual: TestObservable, fixture: TestObservable) {\n        const results: TestMessage[] = [];\n        let subscription: Subscription;\n        const scheduler = getTestScheduler();\n\n        scheduler.schedule(() => {\n          subscription = actual.subscribe(\n            (x: any) => {\n              let value = x;\n\n              // Support Observable-of-Observables\n              if (x instanceof Observable) {\n                value = materializeInnerObservable(value, scheduler.frame);\n              }\n\n              results.push({\n                frame: scheduler.frame,\n                notification: Notification.createNext(value),\n              });\n            },\n            (err: any) => {\n              results.push({\n                frame: scheduler.frame,\n                notification: Notification.createError(err),\n              });\n            },\n            () => {\n              results.push({\n                frame: scheduler.frame,\n                notification: Notification.createComplete(),\n              });\n            },\n          );\n        });\n        scheduler.flush();\n\n        const expected = TestScheduler.parseMarbles(\n          fixture.marbles,\n          fixture.values,\n          fixture.error,\n          true,\n          true,\n        );\n\n        expect(results).toEqual(expected);\n\n        return { pass: true };\n      },\n    }),\n  });\n}\n\nif (typeof module === 'object' && module.exports) {\n  jasmine.getEnv().beforeAll(() => addMatchers());\n\n  jasmine.getEnv().beforeEach(() => initTestScheduler());\n  jasmine.getEnv().afterEach(() => {\n    getTestScheduler().flush();\n    resetTestScheduler();\n  });\n}\n"]}